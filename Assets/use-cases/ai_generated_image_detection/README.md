## Use Case 40: AI-Generated Image Detection

Classify whether an image is generated by an AI or not

- `Industry: Banking`
- `Problem Type: Image Classification`
- `Data Type: Image`

![](https://github.com/h2oai/ht-catalog/blob/646864e3c695f7c721514159bd6c59520dab7438/Assets/use-cases/ai_generated_image_detection/cover.png)
![](https://github.com/h2oai/ht-catalog/blob/646864e3c695f7c721514159bd6c59520dab7438/Assets/use-cases/ai_generated_image_detection/cover.jpg)
![](https://github.com/h2oai/ht-catalog/blob/646864e3c695f7c721514159bd6c59520dab7438/Assets/use-cases/ai_generated_image_detection/cover.jpeg)
![](https://github.com/h2oai/ht-catalog/blob/646864e3c695f7c721514159bd6c59520dab7438/Assets/use-cases/ai_generated_image_detection/cover.webp)
![](https://github.com/h2oai/ht-catalog/blob/646864e3c695f7c721514159bd6c59520dab7438/Assets/use-cases/ai_generated_image_detection/cover)

### Business Problem 

An AI Generated Image Detection model is designed to classify whether an image is generated by an AI or not. With the increasing use of generative models such as GANs and StyleGANs, it has become difficult to distinguish between real and AI-generated images. The model uses machine learning algorithms to identify specific features and patterns that are commonly found in AI-generated images, such as unusual color gradients and pixelation. By classifying images as AI-generated or not, the model can be useful in detecting fake images and preventing their spread. This can be particularly important in areas such as journalism and forensics where the authenticity of images is crucial.

### Impact

AI generated image detection plays a crucial role in addressing the challenges associated with fake or manipulated images. By employing image analysis techniques and deep learning algorithms, it enables the detection and identification of AI-generated or manipulated images. Accurate detection of AI-generated images assists in combating misinformation, protecting intellectual property rights, and ensuring the authenticity of visual content. AI generated image detection technology supports content verification, integrity, and trustworthiness, fostering a more reliable and secure digital environment.

### Dataset

Dataset path: s3://apac-cds/ht_datasets/image_classification/ai-generated-image-detection.zip

100000 train images and 20000 test images with 2 labels [ fake or real ]  Import this link directly in Hydrogen Torch using Amazon S3 ingestion

![train data](https://github.com/h2oai/ht-catalog/blob/646864e3c695f7c721514159bd6c59520dab7438/Assets/use-cases/ai_generated_image_detection/train%20data.png)

### Solution

[H2O Hydrogen Torch](https://docs.h2o.ai/h2o-hydrogen-torch/)

### Model Training

Objective: Classify whether an image is generated by an AI or not

Model Configuration (Hydrogen Torch yaml)

```yaml
architecture:
    backbone: resnet50
    dropout: 0
    pool: Average
    pretrained: true
augmentation:
    augmentations_strategy: Soft
    custom_inference_augmentations: '{"__version__": "1.1.0", "transform": {"__class_fullname__":
        "Compose", "p": 1.0, "transforms": [{"__class_fullname__": "Resize", "always_apply":
        true, "p": 1, "height": IMAGE_HEIGHT, "width": IMAGE_WIDTH, "interpolation":
        1}], "bbox_params": null, "keypoint_params": null, "additional_targets": {}}}'
    custom_train_augmentations: '{"__version__": "1.1.0", "transform": {"__class_fullname__":
        "Compose", "p": 1.0, "transforms": [{"__class_fullname__": "Resize", "always_apply":
        true, "p": 1, "height": IMAGE_HEIGHT, "width": IMAGE_WIDTH, "interpolation":
        1}], "bbox_params": null, "keypoint_params": null, "additional_targets": {}}}'
    cutmix_corner: false
    mix_concentration: 1.0
    mix_image: Disabled
    mix_iterations: 1
    mix_probability: 1.0
    mix_target: Ratio
dataset:
    data_folder: data/anon/ai-generated-image-detection/train/
    data_folder_test: data/anon/ai-generated-image-detection/test/
    data_sample: 1
    data_sample_choice:
    - Train
    - Validation
    folds:
    - '4'
    group_fold_column: image
    image_column: image
    label_columns:
    - class
    test_dataframe: data/anon/ai-generated-image-detection/test.pq
    train_dataframe: data/anon/ai-generated-image-detection/train.pq
    unlabeled_dataframe: None
    validation_dataframe: None
    validation_size: 0.2
    validation_strategy: kfold
environment:
    gpus:
    - '0'
    mixed_precision_inference: false
    mixed_precision_training: true
    number_of_workers: 4
    seed: -1
experiment_name: ai-generated-image-detection
image:
    image_channels: 3
    image_height: 320
    image_normalization: Simple
    image_width: 320
logging:
    logger: None
    neptune_project: ''
    number_of_images: 8
prediction:
    metric: ROC_AUC
    probability_threshold: 0.5
    test_time_augmentations: []
training:
    automatically_adjust_batch_size: false
    batch_size: 32
    build_scoring_pipelines: true
    calculate_train_metric: false
    differential_learning_rate: 0.001
    differential_learning_rate_layers: []
    drop_last_batch: true
    epochs: 5
    evaluation_epochs: 1
    grad_accumulation: 1
    gradient_clip: 0.0
    learning_rate: 0.001
    loss_function: BCE
    optimizer: AdamW
    run_interpretations: true
    save_best_checkpoint: false
    schedule: Cosine
    train_validation_data: false
    warmup_epochs: 0
    weight_decay: 0.0

```

![chart](https://github.com/h2oai/ht-catalog/blob/646864e3c695f7c721514159bd6c59520dab7438/Assets/use-cases/ai_generated_image_detection/chart.png)


### Prediction

![Predictions](https://github.com/h2oai/ht-catalog/blob/646864e3c695f7c721514159bd6c59520dab7438/Assets/use-cases/ai_generated_image_detection/Validation%20Predictions.png)

### License

MIT License

### Acknowledgements

The original dataset used in this use case comes from this source : https://arxiv.org/abs/2303.14126
