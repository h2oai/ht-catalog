2023-06-06 03:33:05,328 - INFO: Starting Hydrogen Torch v1.2.0
2023-06-06 03:33:05,397 - INFO: <pre>Tue Jun  6 03:33:05 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.161.03   Driver Version: 470.161.03   CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla V100-SXM2...  Off  | 00000000:00:1E.0 Off |                    0 |
| N/A   43C    P0    25W / 300W |      2MiB / 16160MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
</pre>
2023-06-06 03:33:05,397 - INFO: Global random seed: 424296
2023-06-06 03:33:05,397 - INFO: Preparing the data...
2023-06-06 03:33:05,397 - INFO: Setting up cross-validation...
2023-06-06 03:33:05,411 - INFO: Running k-fold setup...
2023-06-06 03:33:11,756 - INFO: Preparing train and validation data
2023-06-06 03:33:11,756 - INFO: Loading train dataset...
2023-06-06 03:33:12,067 - INFO: Loading validation dataset...
2023-06-06 03:33:17,368 - INFO: Number of observations in train dataset: 960
2023-06-06 03:33:17,368 - INFO: Number of observations in validation dataset: 240
2023-06-06 03:33:17,375 - INFO: Epoch: 1 / 2
2023-06-06 03:33:17,376 - INFO: train loss:   0%|          | 0/60 [00:00<?, ?it/s]
2023-06-06 03:33:17,827 - INFO: train loss: 0.68:   5%|5         | 3/60 [00:00<00:08,  6.65it/s]
2023-06-06 03:33:18,075 - INFO: train loss: 0.64:  10%|#         | 6/60 [00:00<00:05,  9.05it/s]
2023-06-06 03:33:18,328 - INFO: train loss: 0.60:  15%|#5        | 9/60 [00:00<00:05, 10.15it/s]
2023-06-06 03:33:18,566 - INFO: train loss: 0.54:  20%|##        | 12/60 [00:01<00:04, 10.99it/s]
2023-06-06 03:33:18,809 - INFO: train loss: 0.48:  25%|##5       | 15/60 [00:01<00:03, 11.44it/s]
2023-06-06 03:33:19,048 - INFO: train loss: 0.42:  30%|###       | 18/60 [00:01<00:03, 11.80it/s]
2023-06-06 03:33:19,293 - INFO: train loss: 0.38:  35%|###5      | 21/60 [00:01<00:03, 11.94it/s]
2023-06-06 03:33:19,544 - INFO: train loss: 0.35:  40%|####      | 24/60 [00:02<00:03, 11.94it/s]
2023-06-06 03:33:19,794 - INFO: train loss: 0.32:  45%|####5     | 27/60 [00:02<00:02, 11.96it/s]
2023-06-06 03:33:20,038 - INFO: train loss: 0.30:  50%|#####     | 30/60 [00:02<00:02, 12.06it/s]
2023-06-06 03:33:20,280 - INFO: train loss: 0.28:  55%|#####5    | 33/60 [00:02<00:02, 12.16it/s]
2023-06-06 03:33:20,525 - INFO: train loss: 0.27:  60%|######    | 36/60 [00:03<00:01, 12.19it/s]
2023-06-06 03:33:20,762 - INFO: train loss: 0.26:  65%|######5   | 39/60 [00:03<00:01, 12.33it/s]
2023-06-06 03:33:21,009 - INFO: train loss: 0.25:  70%|#######   | 42/60 [00:03<00:01, 12.27it/s]
2023-06-06 03:33:21,248 - INFO: train loss: 0.25:  75%|#######5  | 45/60 [00:03<00:01, 12.35it/s]
2023-06-06 03:33:21,488 - INFO: train loss: 0.24:  80%|########  | 48/60 [00:04<00:00, 12.40it/s]
2023-06-06 03:33:21,730 - INFO: train loss: 0.23:  85%|########5 | 51/60 [00:04<00:00, 12.39it/s]
2023-06-06 03:33:21,965 - INFO: train loss: 0.23:  90%|######### | 54/60 [00:04<00:00, 12.51it/s]
2023-06-06 03:33:22,195 - INFO: train loss: 0.23:  95%|#########5| 57/60 [00:04<00:00, 12.66it/s]
2023-06-06 03:33:22,424 - INFO: train loss: 0.22: 100%|##########| 60/60 [00:05<00:00, 12.79it/s]
2023-06-06 03:33:22,425 - INFO: train loss: 0.22: 100%|##########| 60/60 [00:05<00:00, 11.88it/s]
2023-06-06 03:33:22,426 - INFO: Starting validation inference
2023-06-06 03:33:22,426 - INFO: validation progress:   0%|          | 0/15 [00:00<?, ?it/s]
2023-06-06 03:33:22,612 - INFO: validation progress:   7%|6         | 1/15 [00:00<00:02,  5.39it/s]
2023-06-06 03:33:22,632 - INFO: validation progress:  13%|#3        | 2/15 [00:00<00:01, 11.32it/s]
2023-06-06 03:33:22,652 - INFO: validation progress:  20%|##        | 3/15 [00:00<00:00, 17.54it/s]
2023-06-06 03:33:22,673 - INFO: validation progress:  27%|##6       | 4/15 [00:00<00:00, 23.41it/s]
2023-06-06 03:33:22,694 - INFO: validation progress:  33%|###3      | 5/15 [00:00<00:00, 28.55it/s]
2023-06-06 03:33:22,715 - INFO: validation progress:  40%|####      | 6/15 [00:00<00:00, 33.21it/s]
2023-06-06 03:33:22,736 - INFO: validation progress:  47%|####6     | 7/15 [00:00<00:00, 36.68it/s]
2023-06-06 03:33:22,758 - INFO: validation progress:  53%|#####3    | 8/15 [00:00<00:00, 39.22it/s]
2023-06-06 03:33:22,779 - INFO: validation progress:  60%|######    | 9/15 [00:00<00:00, 41.22it/s]
2023-06-06 03:33:22,801 - INFO: validation progress:  67%|######6   | 10/15 [00:00<00:00, 42.74it/s]
2023-06-06 03:33:22,820 - INFO: validation progress:  73%|#######3  | 11/15 [00:00<00:00, 45.28it/s]
2023-06-06 03:33:22,839 - INFO: validation progress:  80%|########  | 12/15 [00:00<00:00, 47.24it/s]
2023-06-06 03:33:22,857 - INFO: validation progress:  87%|########6 | 13/15 [00:00<00:00, 49.66it/s]
2023-06-06 03:33:22,874 - INFO: validation progress:  93%|#########3| 14/15 [00:00<00:00, 52.11it/s]
2023-06-06 03:33:22,891 - INFO: validation progress: 100%|##########| 15/15 [00:00<00:00, 53.91it/s]
2023-06-06 03:33:22,893 - INFO: validation progress: 100%|##########| 15/15 [00:00<00:00, 32.17it/s]
2023-06-06 03:33:22,953 - INFO: Mean validation loss: 0.22097
2023-06-06 03:33:22,973 - INFO: Validation ROC_AUC: 0.78074
2023-06-06 03:33:22,985 - ERROR: Stratified random sampling error: 
Traceback (most recent call last):
  File "hydrogen_torch_cythonized/hydrogen_torch/src/utils/data_utils.py", line 276, in hydrogen_torch.src.utils.data_utils.stratified_sample_indices
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/frame.py", line 4111, in query
    res = self.eval(expr, **kwargs)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/frame.py", line 4240, in eval
    return _eval(expr, inplace=inplace, **kwargs)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/eval.py", line 350, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 811, in __init__
    self.terms = self.parse()
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 830, in parse
    return self._visitor.visit(self.expr)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 411, in visit
    raise e
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 407, in visit
    node = ast.fix_missing_locations(ast.parse(clean))
  File "/usr/lib/python3.8/ast.py", line 47, in parse
    return compile(source, filename, mode, flags,
  File "<unknown>", line 1
    label_Bronchial Asthma ==1
                    ^
SyntaxError: invalid syntax
2023-06-06 03:33:23,727 - INFO: Epoch: 2 / 2
2023-06-06 03:33:23,727 - INFO: train loss:   0%|          | 0/60 [00:00<?, ?it/s]
2023-06-06 03:33:24,197 - INFO: train loss: 0.22:   5%|5         | 3/60 [00:00<00:08,  6.39it/s]
2023-06-06 03:33:24,430 - INFO: train loss: 0.22:  10%|#         | 6/60 [00:00<00:05,  9.07it/s]
2023-06-06 03:33:24,667 - INFO: train loss: 0.22:  15%|#5        | 9/60 [00:00<00:04, 10.42it/s]
2023-06-06 03:33:24,902 - INFO: train loss: 0.22:  20%|##        | 12/60 [00:01<00:04, 11.23it/s]
2023-06-06 03:33:25,158 - INFO: train loss: 0.22:  25%|##5       | 15/60 [00:01<00:03, 11.40it/s]
2023-06-06 03:33:25,398 - INFO: train loss: 0.21:  30%|###       | 18/60 [00:01<00:03, 11.76it/s]
2023-06-06 03:33:25,643 - INFO: train loss: 0.21:  35%|###5      | 21/60 [00:01<00:03, 11.91it/s]
2023-06-06 03:33:25,890 - INFO: train loss: 0.21:  40%|####      | 24/60 [00:02<00:03, 11.98it/s]
2023-06-06 03:33:26,140 - INFO: train loss: 0.21:  45%|####5     | 27/60 [00:02<00:02, 11.99it/s]
2023-06-06 03:33:26,380 - INFO: train loss: 0.21:  50%|#####     | 30/60 [00:02<00:02, 12.15it/s]
2023-06-06 03:33:26,620 - INFO: train loss: 0.21:  55%|#####5    | 33/60 [00:02<00:02, 12.25it/s]
2023-06-06 03:33:26,861 - INFO: train loss: 0.21:  60%|######    | 36/60 [00:03<00:01, 12.31it/s]
2023-06-06 03:33:27,097 - INFO: train loss: 0.21:  65%|######5   | 39/60 [00:03<00:01, 12.43it/s]
2023-06-06 03:33:27,336 - INFO: train loss: 0.21:  70%|#######   | 42/60 [00:03<00:01, 12.46it/s]
2023-06-06 03:33:27,577 - INFO: train loss: 0.21:  75%|#######5  | 45/60 [00:03<00:01, 12.46it/s]
2023-06-06 03:33:27,816 - INFO: train loss: 0.21:  80%|########  | 48/60 [00:04<00:00, 12.49it/s]
2023-06-06 03:33:28,053 - INFO: train loss: 0.21:  85%|########5 | 51/60 [00:04<00:00, 12.54it/s]
2023-06-06 03:33:28,290 - INFO: train loss: 0.21:  90%|######### | 54/60 [00:04<00:00, 12.57it/s]
2023-06-06 03:33:28,533 - INFO: train loss: 0.21:  95%|#########5| 57/60 [00:04<00:00, 12.51it/s]
2023-06-06 03:33:28,768 - INFO: train loss: 0.21: 100%|##########| 60/60 [00:05<00:00, 12.58it/s]
2023-06-06 03:33:28,769 - INFO: train loss: 0.21: 100%|##########| 60/60 [00:05<00:00, 11.90it/s]
2023-06-06 03:33:28,770 - INFO: Starting validation inference
2023-06-06 03:33:28,770 - INFO: validation progress:   0%|          | 0/15 [00:00<?, ?it/s]
2023-06-06 03:33:28,951 - INFO: validation progress:   7%|6         | 1/15 [00:00<00:02,  5.55it/s]
2023-06-06 03:33:28,976 - INFO: validation progress:  13%|#3        | 2/15 [00:00<00:01, 11.23it/s]
2023-06-06 03:33:28,996 - INFO: validation progress:  20%|##        | 3/15 [00:00<00:00, 17.30it/s]
2023-06-06 03:33:29,017 - INFO: validation progress:  27%|##6       | 4/15 [00:00<00:00, 23.19it/s]
2023-06-06 03:33:29,039 - INFO: validation progress:  33%|###3      | 5/15 [00:00<00:00, 28.15it/s]
2023-06-06 03:33:29,060 - INFO: validation progress:  40%|####      | 6/15 [00:00<00:00, 32.77it/s]
2023-06-06 03:33:29,081 - INFO: validation progress:  47%|####6     | 7/15 [00:00<00:00, 36.23it/s]
2023-06-06 03:33:29,103 - INFO: validation progress:  53%|#####3    | 8/15 [00:00<00:00, 38.88it/s]
2023-06-06 03:33:29,125 - INFO: validation progress:  60%|######    | 9/15 [00:00<00:00, 40.64it/s]
2023-06-06 03:33:29,147 - INFO: validation progress:  67%|######6   | 10/15 [00:00<00:00, 42.30it/s]
2023-06-06 03:33:29,166 - INFO: validation progress:  73%|#######3  | 11/15 [00:00<00:00, 45.01it/s]
2023-06-06 03:33:29,185 - INFO: validation progress:  80%|########  | 12/15 [00:00<00:00, 46.96it/s]
2023-06-06 03:33:29,202 - INFO: validation progress:  87%|########6 | 13/15 [00:00<00:00, 49.84it/s]
2023-06-06 03:33:29,220 - INFO: validation progress:  93%|#########3| 14/15 [00:00<00:00, 51.89it/s]
2023-06-06 03:33:29,237 - INFO: validation progress: 100%|##########| 15/15 [00:00<00:00, 53.20it/s]
2023-06-06 03:33:29,239 - INFO: validation progress: 100%|##########| 15/15 [00:00<00:00, 31.98it/s]
2023-06-06 03:33:29,294 - INFO: Mean validation loss: 0.20935
2023-06-06 03:33:29,314 - INFO: Validation ROC_AUC: 0.87170
2023-06-06 03:33:29,323 - ERROR: Stratified random sampling error: 
Traceback (most recent call last):
  File "hydrogen_torch_cythonized/hydrogen_torch/src/utils/data_utils.py", line 276, in hydrogen_torch.src.utils.data_utils.stratified_sample_indices
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/frame.py", line 4111, in query
    res = self.eval(expr, **kwargs)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/frame.py", line 4240, in eval
    return _eval(expr, inplace=inplace, **kwargs)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/eval.py", line 350, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 811, in __init__
    self.terms = self.parse()
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 830, in parse
    return self._visitor.visit(self.expr)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 411, in visit
    raise e
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 407, in visit
    node = ast.fix_missing_locations(ast.parse(clean))
  File "/usr/lib/python3.8/ast.py", line 47, in parse
    return compile(source, filename, mode, flags,
  File "<unknown>", line 1
    label_Bronchial Asthma ==1
                    ^
SyntaxError: invalid syntax
2023-06-06 03:33:30,053 - INFO: Saving last model checkpoint: val_loss 0.20935, val_ROC_AUC 0.8717 to output/anon/symptom2disease/fold4/checkpoint.pth
2023-06-06 03:33:30,769 - INFO: Building MLOps and Scoring Pipeline
2023-06-06 03:33:58,378 - INFO: Running interpretability analysis
2023-06-06 03:33:58,382 - ERROR: Stratified random sampling error: 
Traceback (most recent call last):
  File "hydrogen_torch_cythonized/hydrogen_torch/src/utils/data_utils.py", line 276, in hydrogen_torch.src.utils.data_utils.stratified_sample_indices
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/frame.py", line 4111, in query
    res = self.eval(expr, **kwargs)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/frame.py", line 4240, in eval
    return _eval(expr, inplace=inplace, **kwargs)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/eval.py", line 350, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 811, in __init__
    self.terms = self.parse()
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 830, in parse
    return self._visitor.visit(self.expr)
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 411, in visit
    raise e
  File "/resources/venv/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 407, in visit
    node = ast.fix_missing_locations(ast.parse(clean))
  File "/usr/lib/python3.8/ast.py", line 47, in parse
    return compile(source, filename, mode, flags,
  File "<unknown>", line 1
    label_Bronchial Asthma ==1
                    ^
SyntaxError: invalid syntax
2023-06-06 03:34:47,679 - INFO: Interpretability analysis completed
